<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>AthReebo - è–¬è¨˜äº‹ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
      background: #f5f5f5;
      min-height: 100vh;
    }

    .header {
      background: linear-gradient(135deg, #2eb67d 0%, #1e8e5e 100%);
      color: white;
      padding: 20px;
      text-align: center;
    }

    .header h1 {
      font-size: 1.5em;
      margin-bottom: 5px;
    }

    .header p {
      font-size: 0.9em;
      opacity: 0.9;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    .layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    @media (max-width: 1024px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }

    .panel {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      overflow: hidden;
    }

    .panel-header {
      background: #f8f8f8;
      padding: 15px 20px;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .panel-header h2 {
      font-size: 1em;
      color: #333;
    }

    .panel-body {
      padding: 20px;
    }

    textarea {
      width: 100%;
      height: 500px;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      font-family: monospace;
      font-size: 13px;
      resize: vertical;
    }

    textarea:focus {
      outline: none;
      border-color: #2eb67d;
    }

    .btn {
      display: inline-block;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary {
      background: #2eb67d;
      color: white;
    }

    .btn-primary:hover {
      background: #1e8e5e;
    }

    .btn-secondary {
      background: #667eea;
      color: white;
    }

    .btn-secondary:hover {
      background: #5a67d8;
    }

    .btn-outline {
      background: white;
      color: #333;
      border: 1px solid #ddd;
    }

    .btn-outline:hover {
      background: #f5f5f5;
    }

    .btn-group {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .preview-frame {
      height: 500px;
      overflow-y: auto;
      border: 1px solid #ddd;
      border-radius: 8px;
      background: white;
    }

    .tabs {
      display: flex;
      border-bottom: 1px solid #ddd;
    }

    .tab {
      padding: 10px 20px;
      cursor: pointer;
      border-bottom: 2px solid transparent;
      color: #666;
    }

    .tab.active {
      color: #2eb67d;
      border-bottom-color: #2eb67d;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    .error-message {
      background: #ffebee;
      color: #c62828;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      display: none;
    }

    .success-message {
      background: #e8f5e9;
      color: #2e7d32;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 15px;
      display: none;
    }

    .meta-section {
      padding: 10px;
    }

    .meta-group {
      margin-bottom: 20px;
    }

    .meta-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      font-weight: bold;
      font-size: 0.9em;
      color: #333;
    }

    .char-count {
      font-weight: normal;
      font-size: 0.85em;
      color: #666;
      background: #f0f0f0;
      padding: 2px 8px;
      border-radius: 10px;
    }

    .char-count.warning {
      background: #fff3e0;
      color: #e65100;
    }

    .char-count.error {
      background: #ffebee;
      color: #c62828;
    }

    .char-count.success {
      background: #e8f5e9;
      color: #2e7d32;
    }

    .meta-group input,
    .meta-group textarea {
      width: 100%;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 13px;
      margin-bottom: 8px;
    }

    .meta-group input:focus,
    .meta-group textarea:focus {
      outline: none;
      border-color: #2eb67d;
    }

    .btn-sm {
      padding: 6px 12px;
      font-size: 12px;
    }

    /* è¨˜äº‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ã‚¹ã‚¿ã‚¤ãƒ«ï¼ˆCSSã‚’åŸ‹ã‚è¾¼ã¿ï¼‰ */
    .article-content {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      font-family: "Hiragino Kaku Gothic ProN", "Hiragino Sans", Meiryo, sans-serif;
      font-size: 16px;
      line-height: 1.8;
      color: #333;
    }

    .article-content * { box-sizing: border-box; }
    .article-content h1 { font-size: 1.8em; color: #1a1a1a; border-bottom: 3px solid #2eb67d; padding-bottom: 15px; margin: 0 0 25px 0; }
    .article-content h2 { font-size: 1.4em; color: #333; margin: 50px 0 20px 0; padding: 15px 20px; background: linear-gradient(90deg, #e8f5e9 0%, #f1f8e9 100%); border-left: 5px solid #2eb67d; border-radius: 0 8px 8px 0; }
    .article-content h3 { font-size: 1.2em; color: #444; margin: 35px 0 15px 0; padding: 10px 15px; background: #f5f5f5; border-left: 4px solid #78909c; border-radius: 0 6px 6px 0; }
    .article-content p { margin: 1.2em 0; line-height: 2; }
    .article-content ul, .article-content ol { padding-left: 25px; margin: 1.2em 0; }
    .article-content li { margin: 10px 0; line-height: 1.8; }
    .article-content a { color: #2eb67d; text-decoration: none; }
    .article-content hr { border: none; border-top: 1px dashed #ddd; margin: 40px 0; }
    .article-content img { max-width: 100%; height: auto; border-radius: 8px; }

    .article-content .category-badge { display: inline-block; background: #2eb67d; color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.85em; font-weight: bold; margin-bottom: 15px; }
    .article-content .author-byline { display: flex; align-items: center; gap: 12px; margin: 20px 0 30px 0; padding: 15px; background: #fafafa; border-radius: 10px; border-left: 4px solid #2eb67d; }
    .article-content .author-byline img { width: 50px; height: 50px; border-radius: 50%; object-fit: cover; }
    .article-content .author-byline .info { flex: 1; }
    .article-content .author-byline .name { font-weight: bold; color: #333; margin: 0 0 3px 0; font-size: 0.95em; }
    .article-content .author-byline .title { color: #2eb67d; font-size: 0.8em; margin: 0; }
    .article-content .author-byline .date { color: #888; font-size: 0.8em; }
    .article-content .eyecatch { width: 100%; margin: 0 0 30px 0; border-radius: 12px; overflow: hidden; }
    .article-content .eyecatch img { width: 100%; height: auto; display: block; }

    .article-content .toc { background: #f8fdf9; border: 2px solid #c8e6c9; border-radius: 12px; padding: 25px; margin: 30px 0; }
    .article-content .toc-title { font-size: 1.1em; font-weight: bold; color: #2eb67d; margin: 0 0 15px 0; padding-bottom: 10px; border-bottom: 2px dashed #c8e6c9; }
    .article-content .toc-title::before { content: "ğŸ“‹ "; }
    .article-content .toc ol { margin: 0; padding-left: 20px; }
    .article-content .toc li { margin: 8px 0; line-height: 1.6; }
    .article-content .toc a { color: #555; }

    .article-content .point-box { padding: 20px 25px; border-radius: 12px; margin: 25px 0; }
    .article-content .point-box.green { background: linear-gradient(135deg, #e8f5e9 0%, #f1f8e9 100%); border: 1px solid #a5d6a7; }
    .article-content .point-box.blue { background: linear-gradient(135deg, #e3f2fd 0%, #e8eaf6 100%); border: 1px solid #90caf9; }
    .article-content .point-box.yellow { background: linear-gradient(135deg, #fffde7 0%, #fff8e1 100%); border: 1px solid #fff59d; }
    .article-content .point-box.pink { background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%); border: 1px solid #f48fb1; }
    .article-content .point-box.gray { background: linear-gradient(135deg, #f5f5f5 0%, #eeeeee 100%); border: 1px solid #bdbdbd; }
    .article-content .point-box-title { font-weight: bold; font-size: 1.05em; margin: 0 0 10px 0; }

    .article-content .warning-box { padding: 20px 25px; border-radius: 12px; margin: 25px 0; background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%); border-left: 5px solid #ff9800; }
    .article-content .warning-box-title { font-weight: bold; color: #e65100; margin: 0 0 10px 0; }
    .article-content .warning-box-title::before { content: "âš ï¸ "; }

    .article-content .danger-box { padding: 20px 25px; border-radius: 12px; margin: 25px 0; background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%); border-left: 5px solid #f44336; }
    .article-content .danger-box-title { font-weight: bold; color: #c62828; margin: 0 0 10px 0; }
    .article-content .danger-box-title::before { content: "ğŸš« "; }

    .article-content .steps { margin: 30px 0; }
    .article-content .step { display: flex; gap: 20px; margin: 20px 0; padding: 20px; background: #fff; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.06); border: 1px solid #e8e8e8; }
    .article-content .step-number { display: flex; align-items: center; justify-content: center; min-width: 50px; height: 50px; background: linear-gradient(135deg, #2eb67d 0%, #1e8e5e 100%); color: white; border-radius: 50%; font-weight: bold; font-size: 1.3em; }
    .article-content .step-content { flex: 1; }
    .article-content .step-title { font-weight: bold; font-size: 1.05em; color: #333; margin: 0 0 8px 0; }
    .article-content .step-desc { color: #555; margin: 0; line-height: 1.7; }

    .article-content .qa-section { margin: 30px 0; }
    .article-content .qa-item { margin: 20px 0; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
    .article-content .question { display: flex; align-items: flex-start; gap: 15px; padding: 20px; background: linear-gradient(135deg, #e3f2fd 0%, #e8f5e9 100%); font-weight: bold; color: #333; }
    .article-content .question::before { content: "Q"; display: flex; align-items: center; justify-content: center; min-width: 35px; height: 35px; background: #2196f3; color: white; border-radius: 50%; font-weight: bold; }
    .article-content .answer { display: flex; align-items: flex-start; gap: 15px; padding: 20px; background: #fff; border: 1px solid #e0e0e0; border-top: none; }
    .article-content .answer::before { content: "A"; display: flex; align-items: center; justify-content: center; min-width: 35px; height: 35px; background: #ff7043; color: white; border-radius: 50%; font-weight: bold; }
    .article-content .answer-content { flex: 1; }

    .article-content .expert-comment { display: flex; gap: 20px; padding: 25px; margin: 30px 0; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 16px; border: 1px solid #bae6fd; position: relative; }
    .article-content .expert-comment::before { content: "ğŸ’¬ å°‚é–€å®¶ã®è¦‹è§£"; position: absolute; top: -12px; left: 20px; background: #0ea5e9; color: white; padding: 4px 14px; border-radius: 12px; font-size: 0.75em; font-weight: bold; }
    .article-content .expert-comment.doctor::before { content: "ğŸ‘¨â€âš•ï¸ åŒ»å¸«ã®ã‚³ãƒ¡ãƒ³ãƒˆ"; background: #0d9488; }
    .article-content .expert-comment .expert-avatar img { width: 70px; height: 70px; border-radius: 50%; object-fit: cover; border: 3px solid #fff; box-shadow: 0 3px 10px rgba(0,0,0,0.15); }
    .article-content .expert-comment .expert-body { flex: 1; padding-top: 5px; }
    .article-content .expert-comment .expert-name { font-weight: bold; font-size: 0.95em; color: #333; margin: 0 0 2px 0; }
    .article-content .expert-comment .expert-title { font-size: 0.8em; color: #0d9488; margin: 0 0 12px 0; }
    .article-content .expert-comment .expert-text { font-size: 0.95em; line-height: 1.9; color: #444; }
    .article-content .expert-comment .expert-text p { margin: 0 0 10px 0; }

    .article-content .expert-balloon { display: flex; gap: 15px; margin: 30px 0; align-items: flex-start; }
    .article-content .expert-balloon .balloon-avatar { flex-shrink: 0; text-align: center; }
    .article-content .expert-balloon .balloon-avatar img { width: 60px; height: 60px; border-radius: 50%; object-fit: cover; border: 2px solid #e0e0e0; }
    .article-content .expert-balloon .balloon-avatar .balloon-name { font-size: 0.7em; color: #666; margin-top: 5px; display: block; }
    .article-content .expert-balloon .balloon-content { flex: 1; position: relative; background: #f0fdf4; padding: 18px 22px; border-radius: 18px; border: 1px solid #a7f3d0; }
    .article-content .expert-balloon .balloon-content p { margin: 0; line-height: 1.8; font-size: 0.95em; }

    .article-content table { width: 100%; border-collapse: collapse; margin: 25px 0; font-size: 0.95em; }
    .article-content table th { background: #2eb67d; color: white; padding: 12px 15px; text-align: left; }
    .article-content table td { padding: 12px 15px; border-bottom: 1px solid #e0e0e0; }
    .article-content table tr:nth-child(even) { background: #f9f9f9; }

    .article-content .cta-container { text-align: center; margin: 35px 0; }
    .article-content .cta-button { display: inline-block; background: linear-gradient(135deg, #2eb67d 0%, #1e8e5e 100%); color: white !important; padding: 18px 40px; border-radius: 30px; text-decoration: none !important; font-weight: bold; font-size: 1.05em; box-shadow: 0 4px 15px rgba(46,182,125,0.4); }
    .article-content .cta-button.secondary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }

    .article-content .author-box { padding: 25px; background: linear-gradient(135deg, #fafafa 0%, #fff 100%); border-radius: 16px; margin: 40px 0; box-shadow: 0 4px 15px rgba(0,0,0,0.08); border: 1px solid #e8e8e8; }
    .article-content .author-box-label { display: inline-block; background: #2eb67d; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.75em; font-weight: bold; margin-bottom: 15px; }
    .article-content .author-box-header { display: flex; align-items: center; gap: 20px; margin-bottom: 15px; }
    .article-content .author-box img { width: 80px; height: 80px; border-radius: 50%; object-fit: cover; }
    .article-content .author-box .author-name { font-size: 1.15em; font-weight: bold; color: #333; margin: 0 0 5px 0; border-left: 3px solid #2eb67d; padding-left: 10px; }
    .article-content .author-box .author-title { color: #2eb67d; font-size: 0.85em; margin: 0; padding-left: 13px; }
    .article-content .author-box .author-credentials { display: flex; flex-wrap: wrap; gap: 8px; margin: 10px 0 0 13px; }
    .article-content .author-box .credential { background: #e8f5e9; color: #2e7d32; padding: 3px 10px; border-radius: 12px; font-size: 0.75em; }
    .article-content .author-box .author-bio { font-size: 0.9em; line-height: 1.8; color: #555; margin: 0; }

    .article-content .related-articles { margin: 40px 0; }
    .article-content .related-title { font-size: 1.2em; font-weight: bold; color: #333; margin: 0 0 20px 0; padding-bottom: 10px; border-bottom: 2px solid #2eb67d; }
    .article-content .related-title::before { content: "ğŸ“š "; }
    .article-content .related-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
    .article-content .related-card { display: block; text-decoration: none; color: inherit; border: 1px solid #e0e0e0; border-radius: 12px; overflow: hidden; background: #fff; }
    .article-content .related-card img { width: 100%; height: 140px; object-fit: cover; }
    .article-content .related-card-body { padding: 15px; }
    .article-content .related-card-title { font-size: 0.95em; font-weight: bold; color: #333; margin: 0 0 8px 0; }
    .article-content .related-card-desc { font-size: 0.8em; color: #777; margin: 0; }
  </style>
</head>
<body>
  <header class="header">
    <h1>ğŸ¥ AthReebo è–¬è¨˜äº‹ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
    <p>LLMã§ç”Ÿæˆã—ãŸJSONã‚’HTMLè¨˜äº‹ã«å¤‰æ›</p>
  </header>

  <div class="container">
    <div class="layout">
      <!-- å…¥åŠ›ãƒ‘ãƒãƒ« -->
      <div class="panel">
        <div class="panel-header">
          <h2>ğŸ“ JSONå…¥åŠ›</h2>
          <div class="btn-group">
            <button class="btn btn-outline" onclick="loadSample()">ã‚µãƒ³ãƒ—ãƒ«èª­è¾¼</button>
            <button class="btn btn-primary" onclick="generateHTML()">HTMLç”Ÿæˆ</button>
          </div>
        </div>
        <div class="panel-body">
          <div class="error-message" id="errorMsg"></div>
          <div class="success-message" id="successMsg"></div>
          <textarea id="jsonInput" placeholder="LLMã§ç”Ÿæˆã—ãŸJSONã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„..."></textarea>
        </div>
      </div>

      <!-- å‡ºåŠ›ãƒ‘ãƒãƒ« -->
      <div class="panel">
        <div class="panel-header">
          <h2>ğŸ“„ å‡ºåŠ›</h2>
          <div class="btn-group">
            <button class="btn btn-outline tab active" data-tab="preview">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
            <button class="btn btn-outline tab" data-tab="html">HTML</button>
            <button class="btn btn-outline tab" data-tab="meta">Meta/SEO</button>
            <button class="btn btn-secondary" onclick="copyHTML()">HTMLã‚³ãƒ”ãƒ¼</button>
          </div>
        </div>
        <div class="panel-body">
          <div class="tab-content active" id="preview-tab">
            <div class="preview-frame" id="previewFrame"></div>
          </div>
          <div class="tab-content" id="html-tab">
            <textarea id="htmlOutput" readonly style="height: 500px;"></textarea>
          </div>
          <div class="tab-content" id="meta-tab">
            <div class="meta-section">
              <div class="meta-group">
                <div class="meta-label">
                  <span>Meta Title</span>
                  <span class="char-count" id="titleCharCount">0æ–‡å­—</span>
                </div>
                <input type="text" id="metaTitle" readonly>
                <button class="btn btn-outline btn-sm" onclick="copyField('metaTitle')">ã‚³ãƒ”ãƒ¼</button>
              </div>
              <div class="meta-group">
                <div class="meta-label">
                  <span>Meta Description (SEO/AEOæœ€é©åŒ–)</span>
                  <span class="char-count" id="descCharCount">0æ–‡å­—</span>
                </div>
                <textarea id="metaDescription" readonly rows="3"></textarea>
                <button class="btn btn-outline btn-sm" onclick="copyField('metaDescription')">ã‚³ãƒ”ãƒ¼</button>
              </div>
              <div class="meta-group">
                <div class="meta-label">
                  <span>Keywords</span>
                </div>
                <input type="text" id="metaKeywords" readonly>
                <button class="btn btn-outline btn-sm" onclick="copyField('metaKeywords')">ã‚³ãƒ”ãƒ¼</button>
              </div>
              <hr style="margin: 20px 0; border: none; border-top: 1px dashed #ddd;">
              <div class="meta-group">
                <div class="meta-label">
                  <span>HTMLãƒ˜ãƒƒãƒ€ãƒ¼ç”¨Metaã‚¿ã‚°</span>
                </div>
                <textarea id="metaTagsOutput" readonly rows="12" style="font-family: monospace; font-size: 12px;"></textarea>
                <button class="btn btn-primary btn-sm" onclick="copyField('metaTagsOutput')">Metaã‚¿ã‚°ã‚’ã‚³ãƒ”ãƒ¼</button>
              </div>
              <hr style="margin: 20px 0; border: none; border-top: 1px dashed #ddd;">
              <div class="meta-group">
                <div class="meta-label">
                  <span>æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ (JSON-LD)</span>
                </div>
                <textarea id="jsonLdOutput" readonly rows="15" style="font-family: monospace; font-size: 11px;"></textarea>
                <button class="btn btn-secondary btn-sm" onclick="copyField('jsonLdOutput')">JSON-LDã‚’ã‚³ãƒ”ãƒ¼</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab + '-tab').classList.add('active');
      });
    });

    // ã‚µãƒ³ãƒ—ãƒ«JSON
    const sampleJSON = {
      "drug_name": "ãƒ­ã‚³ã‚¤ãƒ‰è»Ÿè†",
      "drug_name_kana": "ã‚ã“ã„ã©ãªã‚“ã“ã†",
      "symptom": "æ¹¿ç–¹ãƒ»çš®è†šç‚ãƒ»ã‹ã‚†ã¿",
      "category": "ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰å¤–ç”¨è–¬",
      "catch_copy": {
        "main": "ç©ã‚„ã‹ã«åŠ¹ã",
        "sub": "é¡”ã«ã‚‚ä½¿ãˆã‚‹å„ªã—ã„ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰"
      },
      "intro": "ãƒ­ã‚³ã‚¤ãƒ‰è»Ÿè†ã¯ã€ãƒ’ãƒ‰ãƒ­ã‚³ãƒ«ãƒã‚¾ãƒ³é…ªé…¸ã‚¨ã‚¹ãƒ†ãƒ«ã‚’ä¸»æˆåˆ†ã¨ã™ã‚‹ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰å¤–ç”¨è–¬ã§ã™ã€‚ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ã®ä¸­ã§ã¯æ¯”è¼ƒçš„ç©ã‚„ã‹ãªåŠ¹æœã§ã€é¡”ã‚„é¦–ãªã©çš®è†šã®è–„ã„éƒ¨åˆ†ã«ã‚‚ä½¿ç”¨ã§ãã‚‹ã®ãŒç‰¹å¾´ã§ã™ã€‚",
      "benefit_list": [
        "ç‚ç—‡ã‚’ç´ æ—©ãæŠ‘ãˆã‚‹",
        "ã‹ã‚†ã¿ã‚’è»½æ¸›ã™ã‚‹",
        "æ¯”è¼ƒçš„å‰¯ä½œç”¨ãŒå°‘ãªã„",
        "é¡”ã‚„é¦–ã«ã‚‚ä½¿ç”¨å¯èƒ½"
      ],
      "problem_list": [
        {
          "problem": "é¡”ã®æ¹¿ç–¹ãŒæ°—ã«ãªã‚‹ã‘ã©ã€ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ã¯æ€–ã„...",
          "solution": "ãƒ­ã‚³ã‚¤ãƒ‰è»Ÿè†ã¯ãƒã‚¤ãƒ«ãƒ‰ãƒ©ãƒ³ã‚¯ã§é¡”ã«ã‚‚å®‰å¿ƒã—ã¦ä½¿ãˆã¾ã™"
        },
        {
          "problem": "å­ã©ã‚‚ã®è‚Œè’ã‚Œã«ä½•ã‚’ä½¿ãˆã°ã„ã„?",
          "solution": "å°å…ã«ã‚‚ä½¿ç”¨å¯èƒ½ãªç©ã‚„ã‹ãªä½œç”¨ã®ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ã§ã™"
        }
      ],
      "doctor_comment": {
        "name": "éµé‡ å¤ªéƒ",
        "title": "QBCã‚¹ã‚­ãƒ³ã‚¯ãƒªãƒ‹ãƒƒã‚¯é™¢é•·",
        "credential": "çš®è†šç§‘å°‚é–€åŒ»ãƒ»åŒ»å­¦åšå£«",
        "image_url": "https://pub-72bbcf8e61fe4f5c89e5b1d0b6409eae.r2.dev/hospital_director_kagino.webp",
        "comments": [
          {
            "context": "åŠ¹æœã«ã¤ã„ã¦",
            "text": "ãƒ­ã‚³ã‚¤ãƒ‰è»Ÿè†ã¯ã€Œãƒã‚¤ãƒ«ãƒ‰ã€ãƒ©ãƒ³ã‚¯ã®ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ã§ã€é¡”ã‚„é¦–ãªã©çš®è†šã®è–„ã„éƒ¨åˆ†ã«é©ã—ã¦ã„ã¾ã™ã€‚æ¹¿ç–¹ã‚„è»½åº¦ã®ã‚¢ãƒˆãƒ”ãƒ¼æ€§çš®è†šç‚ã«åŠ¹æœçš„ã§ã€æ­£ã—ãä½¿ãˆã°å®‰å…¨æ€§ã®é«˜ã„è–¬ã§ã™ã€‚"
          },
          {
            "context": "ä½¿ã„æ–¹ã®ã‚³ãƒ„",
            "text": "å¡—ã‚‹é‡ã®ç›®å®‰ã¨ã—ã¦ã€ŒFTUï¼ˆãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒãƒƒãƒ—ãƒ¦ãƒ‹ãƒƒãƒˆï¼‰ã€ã‚’è¦šãˆã¦ãŠãã¨ä¾¿åˆ©ã§ã™ã€‚äººå·®ã—æŒ‡ã®å…ˆã‹ã‚‰ç¬¬ä¸€é–¢ç¯€ã¾ã§ã®é‡ã§ã€æ‰‹ã®ã²ã‚‰2æšåˆ†ã«å¡—ã‚Œã¾ã™ã€‚è–„ãå¡—ã‚Šã™ãã‚‹ã¨åŠ¹æœãŒå‡ºã«ãã„ã®ã§ã€é©é‡ã‚’å¿ƒãŒã‘ã¦ãã ã•ã„ã­ã€‚"
          }
        ]
      },
      "drug_info": {
        "ingredient": "ãƒ’ãƒ‰ãƒ­ã‚³ãƒ«ãƒã‚¾ãƒ³é…ªé…¸ã‚¨ã‚¹ãƒ†ãƒ«",
        "ingredient_detail": "å‰¯è…çš®è³ªãƒ›ãƒ«ãƒ¢ãƒ³ï¼ˆã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ï¼‰ã®ä¸€ç¨®ã§ã€ç‚ç—‡ã‚’æŠ‘ãˆã‚‹ä½œç”¨ãŒã‚ã‚Šã¾ã™ã€‚",
        "effect": "æ¹¿ç–¹ã€çš®è†šç‚ã€ã‹ã‚†ã¿ã€è™«åˆºã•ã‚Œã€ã‹ã¶ã‚Œãªã©ã®ç—‡çŠ¶ã‚’æ”¹å–„ã—ã¾ã™ã€‚",
        "mechanism": "çš®è†šã®ç‚ç—‡åå¿œã‚’æŠ‘åˆ¶ã—ã€è¡€ç®¡ã®æ‹¡å¼µã‚„æµ®è…«ã‚’è»½æ¸›ã€‚ã¾ãŸã€ã‹ã‚†ã¿ã®åŸå› ã¨ãªã‚‹ç‰©è³ªã®æ”¾å‡ºã‚’æŠ‘ãˆã¾ã™ã€‚",
        "strength_rank": "5æ®µéšä¸­4ç•ªç›®ï¼ˆãƒã‚¤ãƒ«ãƒ‰ï¼‰- æ¯”è¼ƒçš„ç©ã‚„ã‹ãªä½œç”¨",
        "dosage_form": "è»Ÿè†ãƒ»ã‚¯ãƒªãƒ¼ãƒ "
      },
      "usage": {
        "basic": "1æ—¥1ã€œæ•°å›ã€æ‚£éƒ¨ã«é©é‡ã‚’å¡—å¸ƒã—ã¾ã™ã€‚",
        "frequency": "1æ—¥1ã€œ2å›",
        "duration": "ç—‡çŠ¶ãŒæ”¹å–„ã—ãŸã‚‰ä½¿ç”¨ã‚’ä¸­æ­¢ã€‚é•·æœŸé€£ç”¨ã¯é¿ã‘ã‚‹ï¼ˆé€šå¸¸1ã€œ2é€±é–“ç¨‹åº¦ï¼‰",
        "precautions": [
          "å‚·å£ã«ã¯ä½¿ç”¨ã—ãªã„",
          "ç›®ã®å‘¨ã‚Šã¯ç‰¹ã«è–„ãå¡—ã‚‹",
          "é•·æœŸé–“ã®é€£ç”¨ã¯é¿ã‘ã‚‹",
          "æ„ŸæŸ“ç—‡ã®ã‚ã‚‹éƒ¨ä½ã«ã¯ä½¿ç”¨ã—ãªã„"
        ]
      },
      "flow_steps": [
        {
          "step": 1,
          "title": "æ‚£éƒ¨ã‚’æ¸…æ½”ã«ã™ã‚‹",
          "description": "çŸ³é¹¸ã§å„ªã—ãæ´—ã„ã€ã‚¿ã‚ªãƒ«ã§æ°´åˆ†ã‚’æ‹­ãå–ã‚Šã¾ã™ã€‚"
        },
        {
          "step": 2,
          "title": "é©é‡ã‚’æŒ‡ã«å–ã‚‹",
          "description": "äººå·®ã—æŒ‡ã®å…ˆã‹ã‚‰ç¬¬ä¸€é–¢ç¯€ã¾ã§ï¼ˆç´„0.5gï¼‰ãŒç›®å®‰ã§ã™ã€‚"
        },
        {
          "step": 3,
          "title": "æ‚£éƒ¨ã«å¡—ã‚Šåºƒã’ã‚‹",
          "description": "æ“¦ã‚Šè¾¼ã¾ãšã€å„ªã—ãå¡—ã‚Šåºƒã’ã¾ã™ã€‚"
        }
      ],
      "comparison_table": {
        "title": "ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰å¤–ç”¨è–¬ã®å¼·ã•æ¯”è¼ƒ",
        "headers": ["é …ç›®", "ãƒ­ã‚³ã‚¤ãƒ‰", "ãƒªãƒ³ãƒ‡ãƒ­ãƒ³V", "ã‚­ãƒ³ãƒ€ãƒ™ãƒ¼ãƒˆ"],
        "rows": [
          ["å¼·ã•ãƒ©ãƒ³ã‚¯", "ãƒã‚¤ãƒ«ãƒ‰", "ã‚¹ãƒˆãƒ­ãƒ³ã‚°", "ãƒŸãƒ‡ã‚£ã‚¢ãƒ "],
          ["é¡”ã¸ã®ä½¿ç”¨", "â—‹", "â–³", "â—‹"],
          ["å­ã©ã‚‚ã¸ã®ä½¿ç”¨", "â—‹", "â–³", "â—‹"],
          ["å¸‚è²©è–¬", "ãªã—", "ãªã—", "ãªã—"]
        ]
      },
      "price_info": {
        "prescription": {
          "price": "ç´„300ã€œ500å††ï¼ˆ10gï¼‰",
          "insurance": "ä¿é™ºé©ç”¨ã‚ã‚Šã€‚3å‰²è² æ‹…ã§ç´„100ã€œ150å††"
        },
        "otc": {
          "available": false,
          "price_range": "-",
          "products": []
        }
      },
      "side_effects": {
        "common": [
          {
            "symptom": "çš®è†šã®åˆºæ¿€æ„Ÿ",
            "frequency": "ä½¿ç”¨åˆæœŸã«ã¾ã‚Œã«",
            "action": "ç—‡çŠ¶ãŒç¶šãå ´åˆã¯ä½¿ç”¨ã‚’ä¸­æ­¢ã—åŒ»å¸«ã«ç›¸è«‡"
          }
        ],
        "rare": [
          {
            "symptom": "çš®è†šèç¸®ï¼ˆé•·æœŸä½¿ç”¨æ™‚ï¼‰",
            "action": "é•·æœŸé€£ç”¨ã‚’é¿ã‘ã€åŒ»å¸«ã®æŒ‡ç¤ºã«å¾“ã†"
          }
        ],
        "contraindications": [
          "ç´°èŒãƒ»çœŸèŒãƒ»ã‚¦ã‚¤ãƒ«ã‚¹æ„ŸæŸ“ã®ã‚ã‚‹éƒ¨ä½",
          "å‚·å£ãƒ»æ½°ç˜ã®ã‚ã‚‹éƒ¨ä½",
          "æœ¬å‰¤ã®æˆåˆ†ã«ã‚¢ãƒ¬ãƒ«ã‚®ãƒ¼ã®ã‚ã‚‹æ–¹"
        ]
      },
      "faq": [
        {
          "question": "é¡”ã«æ¯æ—¥å¡—ã£ã¦ã‚‚å¤§ä¸ˆå¤«ã§ã™ã‹?",
          "answer": "çŸ­æœŸé–“ã§ã‚ã‚Œã°å•é¡Œã‚ã‚Šã¾ã›ã‚“ãŒã€é•·æœŸé€£ç”¨ã¯é¿ã‘ã¦ãã ã•ã„ã€‚ç—‡çŠ¶ãŒæ”¹å–„ã—ãŸã‚‰ä½¿ç”¨ã‚’ä¸­æ­¢ã—ã€1ã€œ2é€±é–“ä»¥ä¸Šç¶šãå ´åˆã¯åŒ»å¸«ã«ç›¸è«‡ã—ã¦ãã ã•ã„ã€‚"
        },
        {
          "question": "èµ¤ã¡ã‚ƒã‚“ã«ã‚‚ä½¿ãˆã¾ã™ã‹?",
          "answer": "åŒ»å¸«ã®æŒ‡ç¤ºã®ã‚‚ã¨ã§ä½¿ç”¨å¯èƒ½ã§ã™ã€‚ãŸã ã—ã€ä¹³å¹¼å…ã¯çš®è†šãŒè–„ãã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ã®å¸åç‡ãŒé«˜ã„ãŸã‚ã€ä½¿ç”¨éƒ¨ä½ã‚„æœŸé–“ã«ã¯æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚"
        },
        {
          "question": "å¸‚è²©ã§è²·ãˆã¾ã™ã‹?",
          "answer": "ãƒ­ã‚³ã‚¤ãƒ‰è»Ÿè†ã¯å‡¦æ–¹è–¬ã®ãŸã‚ã€å¸‚è²©ã§ã¯è³¼å…¥ã§ãã¾ã›ã‚“ã€‚çš®è†šç§‘ã‚’å—è¨ºã—ã¦å‡¦æ–¹ã—ã¦ã‚‚ã‚‰ã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚"
        }
      ],
      "user_voice": [
        {
          "age": "30ä»£",
          "gender": "å¥³æ€§",
          "symptom": "é¡”ã®æ¹¿ç–¹",
          "comment": "é¡”ã®æ¹¿ç–¹ã«æ‚©ã‚“ã§ã„ã¾ã—ãŸãŒã€ãƒ­ã‚³ã‚¤ãƒ‰è»Ÿè†ã‚’å¡—ã£ãŸã‚‰æ•°æ—¥ã§æ”¹å–„ã—ã¾ã—ãŸã€‚å‰¯ä½œç”¨ã‚‚ç‰¹ã«æ„Ÿã˜ã¾ã›ã‚“ã§ã—ãŸã€‚",
          "rating": 5
        },
        {
          "age": "40ä»£",
          "gender": "ç”·æ€§",
          "symptom": "æ‰‹ã®æ¹¿ç–¹",
          "comment": "ç©ã‚„ã‹ãªåŠ¹ãç›®ã§ã™ãŒã€è»½ã„ç—‡çŠ¶ã«ã¯ååˆ†ã§ã—ãŸã€‚å¼·ã„ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰ãŒå¿ƒé…ãªæ–¹ã«ãŠã™ã™ã‚ã§ã™ã€‚",
          "rating": 4
        }
      ],
      "competitors": [
        {
          "name": "ã‚­ãƒ³ãƒ€ãƒ™ãƒ¼ãƒˆè»Ÿè†",
          "comparison": "åŒã˜ãã‚‰ã„ã®å¼·ã•ï¼ˆãƒŸãƒ‡ã‚£ã‚¢ãƒ ï¼‰ã€‚ã©ã¡ã‚‰ã‚‚é¡”ã«ä½¿ç”¨å¯èƒ½ã€‚",
          "recommendation": "åŠ¹æœã«å¤§ããªå·®ã¯ãªãã€ã©ã¡ã‚‰ã‚‚é¸æŠè‚¢ã¨ã—ã¦é©åˆ‡ã§ã™ã€‚"
        }
      ],
      "cta": {
        "primary_text": "çš®è†šç§‘ã‚’æ¢ã™",
        "primary_url": "#",
        "secondary_text": "ã‚ªãƒ³ãƒ©ã‚¤ãƒ³è¨ºç™‚ã‚’åˆ©ç”¨ã™ã‚‹",
        "secondary_url": "#"
      },
      "related_articles": [
        {
          "title": "ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰å¤–ç”¨è–¬ã®å¼·ã•ãƒ©ãƒ³ã‚¯ä¸€è¦§",
          "description": "ã‚¹ãƒˆãƒ­ãƒ³ã‚²ã‚¹ãƒˆã‹ã‚‰ã‚¦ã‚£ãƒ¼ã‚¯ã¾ã§ã€å…¨5æ®µéšã‚’è§£èª¬",
          "url": "#"
        },
        {
          "title": "é¡”ã®æ¹¿ç–¹ã®åŸå› ã¨å¯¾å‡¦æ³•",
          "description": "çš®è†šç§‘åŒ»ãŒè§£èª¬ã™ã‚‹æ­£ã—ã„ã‚±ã‚¢æ–¹æ³•",
          "url": "#"
        }
      ],
      "meta": {
        "title": "ãƒ­ã‚³ã‚¤ãƒ‰è»Ÿè†ã®åŠ¹æœã¨æ­£ã—ã„ä½¿ã„æ–¹ï½œé¡”ã«ã‚‚ä½¿ãˆã‚‹å„ªã—ã„ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰",
        "description": "ãƒ­ã‚³ã‚¤ãƒ‰è»Ÿè†ã®åŠ¹æœã€ä½¿ã„æ–¹ã€å‰¯ä½œç”¨ã‚’çš®è†šç§‘å°‚é–€åŒ»ãŒè§£èª¬ã€‚ãƒã‚¤ãƒ«ãƒ‰ãƒ©ãƒ³ã‚¯ã§é¡”ã‚„é¦–ã«ã‚‚ä½¿ç”¨å¯èƒ½ãªã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰å¤–ç”¨è–¬ã§ã™ã€‚",
        "keywords": ["ãƒ­ã‚³ã‚¤ãƒ‰è»Ÿè†", "ã‚¹ãƒ†ãƒ­ã‚¤ãƒ‰", "æ¹¿ç–¹", "çš®è†šç‚", "é¡”"]
      },
      "last_updated": "2024-01-27",
      "medical_disclaimer": "ã“ã®è¨˜äº‹ã¯åŒ»ç™‚æƒ…å ±ã®æä¾›ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€åŒ»å¸«ã®è¨ºæ–­ãƒ»æ²»ç™‚ã®ä»£ã‚ã‚Šã¨ãªã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ç—‡çŠ¶ãŒã‚ã‚‹å ´åˆã¯å¿…ãšåŒ»å¸«ã«ç›¸è«‡ã—ã¦ãã ã•ã„ã€‚"
    };

    function loadSample() {
      document.getElementById('jsonInput').value = JSON.stringify(sampleJSON, null, 2);
      showSuccess('ã‚µãƒ³ãƒ—ãƒ«JSONã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');
    }

    function showError(msg) {
      const el = document.getElementById('errorMsg');
      el.textContent = msg;
      el.style.display = 'block';
      document.getElementById('successMsg').style.display = 'none';
    }

    function showSuccess(msg) {
      const el = document.getElementById('successMsg');
      el.textContent = msg;
      el.style.display = 'block';
      document.getElementById('errorMsg').style.display = 'none';
    }

    function generateHTML() {
      try {
        const jsonStr = document.getElementById('jsonInput').value;
        const data = JSON.parse(jsonStr);
        const html = buildHTML(data);

        document.getElementById('previewFrame').innerHTML = html;
        document.getElementById('htmlOutput').value = html;

        // Meta/SEOæƒ…å ±ã‚’ç”Ÿæˆ
        generateMetaInfo(data);

        showSuccess('HTMLç”Ÿæˆå®Œäº†ï¼');
      } catch (e) {
        showError('JSONãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼: ' + e.message);
      }
    }

    // SEO/AEOæœ€é©åŒ–ã•ã‚ŒãŸãƒ¡ã‚¿ãƒ‡ã‚£ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•ç”Ÿæˆ
    function generateMetaDescription(d) {
      // AEO (Answer Engine Optimization) ã‚’è€ƒæ…®ã—ãŸè³ªå•å¿œç­”å½¢å¼
      // 70-150æ–‡å­—ã§ã€æ¤œç´¢æ„å›³ã«ç›´æ¥å›ç­”ã™ã‚‹å½¢å¼

      const drugName = d.drug_name;
      const symptom = d.symptom;
      const mainBenefit = d.benefit_list[0];
      const ingredient = d.drug_info?.ingredient || '';
      const strengthRank = d.drug_info?.strength_rank || '';

      // è¤‡æ•°ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰æœ€é©ãªã‚‚ã®ã‚’é¸æŠ
      const patterns = [
        // ãƒ‘ã‚¿ãƒ¼ãƒ³1: è³ªå•å¿œç­”å‹ï¼ˆAEOæœ€é©åŒ–ï¼‰
        `${drugName}ã¯${symptom}ã«åŠ¹æœçš„ãªè–¬ã§ã™ã€‚${mainBenefit}ã¨ã„ã†ç‰¹å¾´ãŒã‚ã‚Šã€åŒ»å¸«ã®æŒ‡å°ã®ã‚‚ã¨æ­£ã—ãä½¿ç”¨ã™ã‚‹ã“ã¨ã§å®‰å…¨ã«ç—‡çŠ¶ã‚’æ”¹å–„ã§ãã¾ã™ã€‚`,

        // ãƒ‘ã‚¿ãƒ¼ãƒ³2: æˆåˆ†ãƒ»åŠ¹èƒ½å‹
        `${drugName}ï¼ˆ${ingredient}ï¼‰ã®åŠ¹æœãƒ»ä½¿ã„æ–¹ãƒ»å‰¯ä½œç”¨ã‚’å°‚é–€åŒ»ãŒè§£èª¬ã€‚${symptom}ã®æ²»ç™‚ã«ä½¿ã‚ã‚Œã€${mainBenefit}ã€‚æ­£ã—ã„ä½¿ç”¨æ³•ã¨æ³¨æ„ç‚¹ã‚’è©³ã—ãç´¹ä»‹ã—ã¾ã™ã€‚`,

        // ãƒ‘ã‚¿ãƒ¼ãƒ³3: ç›´æ¥å›ç­”å‹
        `ã€åŒ»å¸«ç›£ä¿®ã€‘${drugName}ã¯${symptom}ã«å‡¦æ–¹ã•ã‚Œã‚‹è–¬ã§ã™ã€‚${strengthRank ? strengthRank + 'ã§ã€' : ''}${mainBenefit}ã€‚åŠ¹æœãƒ»å‰¯ä½œç”¨ãƒ»ä½¿ã„æ–¹ã‚’è§£èª¬ã—ã¾ã™ã€‚`
      ];

      // å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ–‡å­—æ•°ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€70-150æ–‡å­—ã«åã¾ã‚‹ã‚‚ã®ã‚’å„ªå…ˆ
      for (const pattern of patterns) {
        const cleaned = pattern.replace(/\s+/g, '');
        if (cleaned.length >= 70 && cleaned.length <= 150) {
          return pattern;
        }
      }

      // ã©ã‚Œã‚‚æ¡ä»¶ã«åˆã‚ãªã„å ´åˆã€æœ€åˆã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’èª¿æ•´
      let description = patterns[0];
      const length = description.replace(/\s+/g, '').length;

      if (length < 70) {
        // çŸ­ã™ãã‚‹å ´åˆã¯è¿½åŠ æƒ…å ±ã‚’ä»˜åŠ 
        description += `ä½¿ç”¨æ–¹æ³•ã‚„å‰¯ä½œç”¨ã«ã¤ã„ã¦ã‚‚è©³ã—ãè§£èª¬ã—ã¦ã„ã¾ã™ã€‚`;
      } else if (length > 150) {
        // é•·ã™ãã‚‹å ´åˆã¯åˆ‡ã‚Šè©°ã‚
        description = description.substring(0, 147) + '...';
      }

      return description;
    }

    // ãƒ¡ã‚¿æƒ…å ±å…¨ä½“ã‚’ç”Ÿæˆ
    function generateMetaInfo(d) {
      // Meta Title (60æ–‡å­—ä»¥å†…æ¨å¥¨)
      const metaTitle = d.meta?.title ||
        `${d.drug_name}ã®åŠ¹æœã¨æ­£ã—ã„ä½¿ã„æ–¹ï½œ${d.catch_copy?.sub || 'å°‚é–€åŒ»ãŒè§£èª¬'}`;

      // Meta Description (70-150æ–‡å­—)
      const metaDescription = d.meta?.description || generateMetaDescription(d);

      // Keywords
      const keywords = d.meta?.keywords ||
        [d.drug_name, d.symptom, d.drug_info?.ingredient, d.category].filter(Boolean);

      // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¨­å®š
      document.getElementById('metaTitle').value = metaTitle;
      document.getElementById('metaDescription').value = metaDescription;
      document.getElementById('metaKeywords').value = Array.isArray(keywords) ? keywords.join(', ') : keywords;

      // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–°
      updateCharCount('titleCharCount', metaTitle.length, 30, 60);
      updateCharCount('descCharCount', metaDescription.replace(/\s+/g, '').length, 70, 150);

      // HTMLãƒ˜ãƒƒãƒ€ãƒ¼ç”¨Metaã‚¿ã‚°ã‚’ç”Ÿæˆ
      const metaTags = generateMetaTags(d, metaTitle, metaDescription, keywords);
      document.getElementById('metaTagsOutput').value = metaTags;

      // JSON-LDã‚’ç”Ÿæˆ
      const jsonLd = generateJsonLd(d, metaTitle, metaDescription);
      document.getElementById('jsonLdOutput').value = JSON.stringify(jsonLd, null, 2);
    }

    // æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆã‚’æ›´æ–°
    function updateCharCount(elementId, count, min, max) {
      const el = document.getElementById(elementId);
      el.textContent = `${count}æ–‡å­—`;
      el.classList.remove('warning', 'error', 'success');

      if (count < min) {
        el.classList.add('warning');
        el.textContent += ` (${min}æ–‡å­—ä»¥ä¸Šæ¨å¥¨)`;
      } else if (count > max) {
        el.classList.add('error');
        el.textContent += ` (${max}æ–‡å­—ä»¥ä¸‹æ¨å¥¨)`;
      } else {
        el.classList.add('success');
        el.textContent += ' âœ“';
      }
    }

    // HTMLãƒ˜ãƒƒãƒ€ãƒ¼ç”¨Metaã‚¿ã‚°ã‚’ç”Ÿæˆ
    function generateMetaTags(d, title, description, keywords) {
      const keywordsStr = Array.isArray(keywords) ? keywords.join(', ') : keywords;
      const imageUrl = d.eyecatch_image_url || `https://placehold.co/1200x630/e8f5e9/2eb67d?text=${encodeURIComponent(d.drug_name)}`;
      const url = d.canonical_url || '#';

      return `<!-- åŸºæœ¬Meta -->
<meta name="description" content="${description}">
<meta name="keywords" content="${keywordsStr}">
<meta name="author" content="${d.doctor_comment?.name || 'QBCã‚¹ã‚­ãƒ³ã‚¯ãƒªãƒ‹ãƒƒã‚¯'}">

<!-- Open Graph (Facebook/LINEç­‰) -->
<meta property="og:title" content="${title}">
<meta property="og:description" content="${description}">
<meta property="og:type" content="article">
<meta property="og:url" content="${url}">
<meta property="og:image" content="${imageUrl}">
<meta property="og:site_name" content="QBCã‚¹ã‚­ãƒ³ã‚¯ãƒªãƒ‹ãƒƒã‚¯">
<meta property="og:locale" content="ja_JP">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="${title}">
<meta name="twitter:description" content="${description}">
<meta name="twitter:image" content="${imageUrl}">

<!-- è¿½åŠ SEO -->
<meta name="robots" content="index, follow">
<link rel="canonical" href="${url}">`;
    }

    // åŒ»ç™‚è¨˜äº‹ç”¨JSON-LDæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
    function generateJsonLd(d, title, description) {
      const now = new Date().toISOString();

      return {
        "@context": "https://schema.org",
        "@type": "MedicalWebPage",
        "name": title,
        "description": description,
        "url": d.canonical_url || "",
        "datePublished": d.last_updated || now.split('T')[0],
        "dateModified": now.split('T')[0],
        "author": {
          "@type": "Person",
          "name": d.doctor_comment?.name || "",
          "jobTitle": d.doctor_comment?.title || "",
          "affiliation": {
            "@type": "MedicalClinic",
            "name": "QBCã‚¹ã‚­ãƒ³ã‚¯ãƒªãƒ‹ãƒƒã‚¯"
          }
        },
        "publisher": {
          "@type": "Organization",
          "name": "QBCã‚¹ã‚­ãƒ³ã‚¯ãƒªãƒ‹ãƒƒã‚¯",
          "logo": {
            "@type": "ImageObject",
            "url": "https://pub-72bbcf8e61fe4f5c89e5b1d0b6409eae.r2.dev/qbc_logo.png"
          }
        },
        "mainEntity": {
          "@type": "Drug",
          "name": d.drug_name,
          "activeIngredient": d.drug_info?.ingredient || "",
          "drugClass": d.category || "",
          "description": d.intro || ""
        },
        "about": {
          "@type": "MedicalCondition",
          "name": d.symptom
        },
        "medicalAudience": {
          "@type": "MedicalAudience",
          "audienceType": "Patient"
        },
        "inLanguage": "ja",
        "isAccessibleForFree": true,
        "speakable": {
          "@type": "SpeakableSpecification",
          "cssSelector": [".article-content h1", ".article-content .intro", ".article-content .point-box"]
        }
      };
    }

    // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
    function copyField(fieldId) {
      const field = document.getElementById(fieldId);
      navigator.clipboard.writeText(field.value).then(() => {
        showSuccess('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
      });
    }

    function buildHTML(d) {
      // æ˜Ÿè©•ä¾¡ã‚’ç”Ÿæˆ
      function stars(rating) {
        return 'â˜…'.repeat(rating) + 'â˜†'.repeat(5 - rating);
      }

      return `<div class="article-content">

<span class="category-badge">${d.category}</span>

<h1>${d.drug_name}ã®åŠ¹æœã¨æ­£ã—ã„ä½¿ã„æ–¹ï½œ${d.catch_copy.sub}</h1>

<div class="author-byline">
  <img src="${d.doctor_comment.image_url}" alt="${d.doctor_comment.name}">
  <div class="info">
    <p class="name">${d.doctor_comment.name}ï¼ˆ${d.doctor_comment.title}ï¼‰</p>
    <p class="title">${d.doctor_comment.credential}</p>
  </div>
  <span class="date">${d.last_updated} æ›´æ–°</span>
</div>

<div class="eyecatch">
  <img src="https://placehold.co/800x400/e8f5e9/2eb67d?text=${encodeURIComponent(d.drug_name)}" alt="${d.drug_name}">
</div>

<p>${d.intro}</p>

<div class="toc">
  <p class="toc-title">ã“ã®è¨˜äº‹ã®ç›®æ¬¡</p>
  <ol>
    <li><a href="#section-benefits">${d.drug_name}ã®ãƒ¡ãƒªãƒƒãƒˆãƒ»åŠ¹æœ</a></li>
    <li><a href="#section-info">æˆåˆ†ãƒ»ä½œç”¨æ©Ÿåº</a></li>
    <li><a href="#section-usage">æ­£ã—ã„ä½¿ã„æ–¹</a></li>
    <li><a href="#section-comparison">é¡ä¼¼è–¬ã¨ã®æ¯”è¼ƒ</a></li>
    <li><a href="#section-side-effects">å‰¯ä½œç”¨ã¨æ³¨æ„ç‚¹</a></li>
    <li><a href="#section-price">ä¾¡æ ¼ãƒ»å…¥æ‰‹æ–¹æ³•</a></li>
    <li><a href="#section-faq">ã‚ˆãã‚ã‚‹è³ªå•</a></li>
    <li><a href="#section-voice">ä½¿ç”¨è€…ã®å£°</a></li>
  </ol>
</div>

<h2 id="section-benefits">${d.drug_name}ã®ãƒ¡ãƒªãƒƒãƒˆãƒ»åŠ¹æœ</h2>

<div class="point-box green">
  <p class="point-box-title">ğŸ’¡ ${d.drug_name}ã®ç‰¹å¾´</p>
  <ul>
    ${d.benefit_list.map(b => `<li>${b}</li>`).join('\n    ')}
  </ul>
</div>

<h3>ã“ã‚“ãªæ‚©ã¿ã«åŠ¹æœçš„</h3>

${d.problem_list.map(p => `<div class="point-box blue">
  <p class="point-box-title">ğŸ˜Ÿ ${p.problem}</p>
  <p>â†’ <strong>${p.solution}</strong></p>
</div>`).join('\n\n')}

<div class="expert-comment doctor">
  <div class="expert-avatar">
    <img src="${d.doctor_comment.image_url}" alt="${d.doctor_comment.name}">
  </div>
  <div class="expert-body">
    <p class="expert-name">${d.doctor_comment.name}ï¼ˆ${d.doctor_comment.title}ï¼‰</p>
    <p class="expert-title">${d.doctor_comment.credential}</p>
    <div class="expert-text">
      <p>${d.doctor_comment.comments[0].text}</p>
    </div>
  </div>
</div>

<h2 id="section-info">${d.drug_name}ã®æˆåˆ†ãƒ»ä½œç”¨æ©Ÿåº</h2>

<h3>ä¸»æˆåˆ†</h3>
<p><strong>${d.drug_info.ingredient}</strong></p>
<p>${d.drug_info.ingredient_detail}</p>

<h3>åŠ¹æœãƒ»åŠ¹èƒ½</h3>
<p>${d.drug_info.effect}</p>

<h3>ä½œç”¨æ©Ÿåºï¼ˆãªãœåŠ¹ãã®ã‹ï¼‰</h3>
<p>${d.drug_info.mechanism}</p>

${d.drug_info.strength_rank ? `<div class="point-box yellow">
  <p class="point-box-title">ğŸ“Š è–¬ã®å¼·ã•ãƒ©ãƒ³ã‚¯</p>
  <p>${d.drug_info.strength_rank}</p>
</div>` : ''}

<h2 id="section-usage">${d.drug_name}ã®æ­£ã—ã„ä½¿ã„æ–¹</h2>

<p>${d.usage.basic}</p>

<div class="steps">
  ${d.flow_steps.map(s => `<div class="step">
    <span class="step-number">${s.step}</span>
    <div class="step-content">
      <p class="step-title">${s.title}</p>
      <p class="step-desc">${s.description}</p>
    </div>
  </div>`).join('\n  ')}
</div>

<div class="point-box yellow">
  <p class="point-box-title">â° ä½¿ç”¨é »åº¦ãƒ»æœŸé–“</p>
  <p><strong>ä½¿ç”¨é »åº¦ï¼š</strong>${d.usage.frequency}</p>
  <p><strong>ä½¿ç”¨æœŸé–“ã®ç›®å®‰ï¼š</strong>${d.usage.duration}</p>
</div>

${d.doctor_comment.comments[1] ? `<div class="expert-balloon green">
  <div class="balloon-avatar">
    <img src="${d.doctor_comment.image_url}" alt="${d.doctor_comment.name}">
    <span class="balloon-name">éµé‡é™¢é•·</span>
  </div>
  <div class="balloon-content">
    <p>${d.doctor_comment.comments[1].text}</p>
  </div>
</div>` : ''}

<div class="warning-box">
  <p class="warning-box-title">ä½¿ç”¨ä¸Šã®æ³¨æ„ç‚¹</p>
  <ul>
    ${d.usage.precautions.map(p => `<li>${p}</li>`).join('\n    ')}
  </ul>
</div>

<h2 id="section-comparison">${d.comparison_table.title}</h2>

<table>
  <tr>
    ${d.comparison_table.headers.map(h => `<th>${h}</th>`).join('')}
  </tr>
  ${d.comparison_table.rows.map(row => `<tr>
    ${row.map(cell => `<td>${cell}</td>`).join('')}
  </tr>`).join('\n  ')}
</table>

${d.competitors.map(c => `<div class="point-box gray">
  <p class="point-box-title">ğŸ”„ ${c.name}ã¨ã®æ¯”è¼ƒ</p>
  <p>${c.comparison}</p>
  <p><strong>ãŠã™ã™ã‚ï¼š</strong>${c.recommendation}</p>
</div>`).join('\n\n')}

<h2 id="section-side-effects">å‰¯ä½œç”¨ã¨æ³¨æ„ç‚¹</h2>

<h3>ã‚ˆãã‚ã‚‹å‰¯ä½œç”¨</h3>

${d.side_effects.common.map(s => `<div class="point-box pink">
  <p class="point-box-title">${s.symptom}ï¼ˆ${s.frequency}ï¼‰</p>
  <p><strong>å¯¾å‡¦æ³•ï¼š</strong>${s.action}</p>
</div>`).join('\n\n')}

<h3>ã¾ã‚Œãªå‰¯ä½œç”¨</h3>

${d.side_effects.rare.map(s => `<div class="warning-box">
  <p class="warning-box-title">${s.symptom}</p>
  <p>${s.action}</p>
</div>`).join('\n\n')}

<div class="danger-box">
  <p class="danger-box-title">ä½¿ç”¨ã—ã¦ã¯ã„ã‘ãªã„ã‚±ãƒ¼ã‚¹</p>
  <ul>
    ${d.side_effects.contraindications.map(c => `<li>${c}</li>`).join('\n    ')}
  </ul>
</div>

<h2 id="section-price">ä¾¡æ ¼ãƒ»å…¥æ‰‹æ–¹æ³•</h2>

<h3>å‡¦æ–¹è–¬ã¨ã—ã¦</h3>
<p><strong>ä¾¡æ ¼ç›®å®‰ï¼š</strong>${d.price_info.prescription.price}</p>
<p><strong>ä¿é™ºé©ç”¨ï¼š</strong>${d.price_info.prescription.insurance}</p>

${d.price_info.otc.available ? `<h3>å¸‚è²©è–¬ã¨ã—ã¦</h3>
<p><strong>ä¾¡æ ¼å¸¯ï¼š</strong>${d.price_info.otc.price_range}</p>
<ul>
  ${d.price_info.otc.products.map(p => `<li>${p}</li>`).join('\n  ')}
</ul>` : ''}

<div class="cta-container">
  <a href="${d.cta.primary_url}" class="cta-button">${d.cta.primary_text}</a>
</div>

<h2 id="section-faq">ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆQ&Aï¼‰</h2>

<div class="qa-section">
  ${d.faq.map(f => `<div class="qa-item">
    <div class="question">${f.question}</div>
    <div class="answer">
      <div class="answer-content">
        <p>${f.answer}</p>
      </div>
    </div>
  </div>`).join('\n  ')}
</div>

<h2 id="section-voice">ä½¿ç”¨è€…ã®å£°</h2>

${d.user_voice.map(v => `<div class="point-box green">
  <p class="point-box-title">ğŸ‘¤ ${v.age}${v.gender}ï¼ˆ${v.symptom}ï¼‰</p>
  <p>ã€Œ${v.comment}ã€</p>
  <p>æº€è¶³åº¦ï¼š${stars(v.rating)}</p>
</div>`).join('\n\n')}

<p><em>â€»å€‹äººã®æ„Ÿæƒ³ã§ã™ã€‚åŠ¹æœã«ã¯å€‹äººå·®ãŒã‚ã‚Šã¾ã™ã€‚</em></p>

<h2>ã¾ã¨ã‚</h2>

<div class="point-box blue">
  <p class="point-box-title">ğŸ“ ã“ã®è¨˜äº‹ã®ãƒã‚¤ãƒ³ãƒˆ</p>
  <ul>
    <li>${d.drug_name}ã¯<strong>${d.symptom}</strong>ã«åŠ¹æœçš„</li>
    <li>ä¸»æˆåˆ†ã¯<strong>${d.drug_info.ingredient}</strong></li>
    <li>ä½¿ç”¨é »åº¦ã¯<strong>${d.usage.frequency}</strong></li>
    <li>å‰¯ä½œç”¨ã«æ³¨æ„ã—ã¦æ­£ã—ãä½¿ç”¨ã™ã‚‹ã“ã¨ãŒå¤§åˆ‡</li>
  </ul>
</div>

<p>${d.medical_disclaimer}</p>

<div class="cta-container">
  <a href="${d.cta.primary_url}" class="cta-button">${d.cta.primary_text}</a>
  ${d.cta.secondary_text ? `<br><br><a href="${d.cta.secondary_url}" class="cta-button secondary">${d.cta.secondary_text}</a>` : ''}
</div>

<hr>

<div class="author-box">
  <span class="author-box-label">ã“ã®è¨˜äº‹ã®ç›£ä¿®è€…</span>
  <div class="author-box-header">
    <img src="${d.doctor_comment.image_url}" alt="${d.doctor_comment.name}">
    <div class="author-info">
      <p class="author-name">${d.doctor_comment.name}</p>
      <p class="author-title">${d.doctor_comment.title}</p>
      <div class="author-credentials">
        <span class="credential">${d.doctor_comment.credential}</span>
      </div>
    </div>
  </div>
  <p class="author-bio">çš®è†šç§‘å°‚é–€åŒ»ã¨ã—ã¦15å¹´ä»¥ä¸Šã®è‡¨åºŠçµŒé¨“ã‚’æŒã¤ã€‚æ‚£è€…ã•ã‚“ä¸€äººã²ã¨ã‚Šã«å¯„ã‚Šæ·»ã£ãŸä¸å¯§ãªè¨ºç™‚ã‚’å¿ƒãŒã‘ã€æœ€æ–°ã®åŒ»å­¦çŸ¥è­˜ã«åŸºã¥ã„ãŸæ²»ç™‚ã‚’æä¾›ã—ã¦ã„ã‚‹ã€‚</p>
</div>

<hr>

<div class="related-articles">
  <p class="related-title">é–¢é€£è¨˜äº‹</p>
  <div class="related-grid">
    ${d.related_articles.map(r => `<a href="${r.url}" class="related-card">
      <img src="https://placehold.co/400x200/e8f5e9/2eb67d?text=Related" alt="${r.title}">
      <div class="related-card-body">
        <p class="related-card-title">${r.title}</p>
        <p class="related-card-desc">${r.description}</p>
      </div>
    </a>`).join('\n    ')}
  </div>
</div>

</div>`;
    }

    function copyHTML() {
      const html = document.getElementById('htmlOutput').value;
      navigator.clipboard.writeText(html).then(() => {
        showSuccess('HTMLã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
      });
    }
  </script>
</body>
</html>
